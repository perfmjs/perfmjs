(function(){var d=window,c=document;var b={isIE:navigator.userAgent.indexOf("MSIE")>0,isIE6:!("minWidth" in c.documentElement.style),getStyle:d.getComputedStyle?function(f,e){return getComputedStyle(f,false)[e]}:function(f,e){return f.currentStyle[e]},getEvent:function(e){return e||d.event},getTarget:function(e){return e.srcElement||e.target},clsSelect:"getSelection" in d?function(){d.getSelection().removeAllRanges()}:function(){try{c.selection.empty()}catch(f){}},each:function(k,l){var f,g=0,h=k.length,e=h===undefined;if(e){for(f in k){if(l.call(k[f],f,k[f])===false){break}}}else{for(var j=k[0];g<h&&l.call(j,g,j)!==false;j=k[++g]){}}return k},addEvent:d.addEventListener?function(f,e,g){f.addEventListener(e,g,false)}:function(f,e,g){f.attachEvent("on"+e,g)},removeEvent:d.removeEventListener?function(f,e,g){f.removeEventListener(e,g,false)}:function(f,e,g){f.detachEvent("on"+e,g)}};var a=function(e){if(!(this instanceof a)){e=e||{};if(typeof e==="string"||e.nodeType===1){e={content:e}}for(var f in a.defaults){if(e[f]===undefined){e[f]=a.defaults[f]}}e.id=e.id||"Dialog-"+ +new Date;if(a.list[e.id]){return a.list[e.id].zIndex()}else{return a.list[e.id]=new a(e)}}this.config=e;this.init()};a.prototype={version:"1.7",constructor:a,init:function(){var f=this,e=f.config;f.DOM=f._getDOM();if(e.lock){f.lock()}if(e.style){f.DOM.layer.className+=" dialogSkin_"+e.style}if(!e.drag){f.DOM.title.style.cursor="default"}if(!e.autoMiddle){f.DOM.body.style.verticalAlign="top";f.DOM.content.style.display="block"}f.closed=false;f.button(e.button).ad(e.ad).title(e.title).icon(e.icon).content(e.content,true).size(e.width,e.height).position(e.left,e.top).zIndex().time(e.time);f.DOM.wrap.className="md_dialog_wrap";f._addEvent();e.init&&e.init.call(f,window);return f},zIndex:function(){var f=this,e=f.DOM.wrap;a.defaults.zIndex+=1;e.style.zIndex=a.defaults.zIndex;return f},title:function(g){var f=this,e=f.DOM;if(g){e.title.innerHTML=g}else{e.head.style.display="none"}return f},icon:function(e){var g=this,f=g.DOM;if(e){f.content.className="md_dialog_content md_dialog_"+e}else{f.content.className="md_dialog_content md_dialog_noIcon"}return g},content:function(h){var m=this,n,k,l,o,e,i=m.config,r=m.DOM,g=r.wrap,f=g.offsetWidth,q=g.offsetHeight,j=parseInt(g.style.left),p=parseInt(g.style.top);m._elemBack&&m._elemBack();g.style.width="auto";g.style.height="auto";if(typeof h==="string"){o=h.replace(/(^\s*)/g,"").substring(0,4);if(o==="url:"){if(m.iframe){m.iframe.className="";m.iframe.src=null;m.iframe.parentNode.removeChild(m.iframe);m.iframe=null}e=h.substr(4);m.iframe=document.createElement("iframe");m.iframe.src=e;m.iframe.setAttribute("frameborder","0",0);m.iframe.className="md_dialog_iframe";r.txt.innerHTML="";r.content.style.display="block";r.content.style.height="100%";r.txt.style.height="100%";r.txt.appendChild(m.iframe)}else{r.txt.innerHTML=h}}else{if(h&&h.nodeType===1){n=b.getStyle(h,"display");k=h.previousSibling;l=h.nextSibling;m._elemBack=function(){if(k&&k.parentNode){k.parentNode.insertBefore(h,k.nextSibling)}else{if(l&&l.parentNode){l.parentNode.insertBefore(h,l)}else{if(parent){parent.appendChild(h)}}}h.style.display=n;m._elemBack=null};r.txt.innerHTML="";r.txt.appendChild(h);h.style.display="block"}}if(!arguments[1]){f=g.offsetWidth-f;q=g.offsetHeight-q;j=j-f/2;p=p-q/2;g.style.left=Math.max(j,0)+"px";g.style.top=Math.max(p,0)+"px"}m._setWrapSize();return m},size:function(g,e){var k=this,j,i,f=k.config,h=k.DOM;h.body.style.padding=f.padding;if(g&&g!=="auto"){j=c.documentElement.clientWidth;g=k._percenttoNumber(g,j);if(typeof g==="number"){h.body.style.width=g+"px"}if(typeof g==="string"){h.body.style.width=g}h.wrap.style.width=h.wrap.offsetWidth+"px"}else{h.body.style.width="auto"}if(e&&e!=="auto"){i=c.documentElement.clientHeight;e=k._percenttoNumber(e,i);if(typeof e==="number"){h.body.style.height=e+"px"}if(typeof e==="string"){h.body.style.height=e}h.wrap.style.height=h.wrap.offsetHeight+"px"}else{h.body.style.height="auto"}return k},position:function(j,r){var p=this,g=p.DOM.wrap,k=b.isIE6?false:p.config.fixed,o=b.isIE6&&p.config.fixed,s=g.offsetWidth,m=g.offsetHeight,f=g.style,l=c.documentElement.clientWidth,e=c.documentElement.clientHeight,q=c.documentElement.scrollTop||c.body.scrollTop,t=c.documentElement.scrollLeft||c.body.scrollLeft,n=k?0:t,i=k?0:q;f.position=k?"fixed":"absolute";if(j||j===0){j=p._percenttoNumber(j,l-s);if(typeof j==="number"){j=o?(j+=t):j+n;f.left=Math.max(j,n)+"px"}else{if(typeof j==="string"){f.left=j}}}if(r||r===0){r=p._percenttoNumber(r,e-m);if(typeof r==="number"){r=o?(r+=q):r+i;f.top=Math.max(r,i)+"px"}else{if(typeof r==="string"){f.top=r}}}return p},button:function(e){if(!e){this.DOM.foot.parentNode.style.display="none";return this}var h=this,g=h.DOM.foot,f=h._listeners=h._listeners||{},i=Object.prototype.toString.call(e).slice(8,-1)==="Array"?e:[e];b.each(i,function(l,n){var j=n.name,m=!f[j],k=!m?f[j].elem:c.createElement("button");if(!f[j]){f[j]={}}if(n.callback){f[j].callback=n.callback}if(n.id){k.id=n.id}if(n.className){k.className=n.className}else{k.className="md_dialog_default_btn"}k.setAttribute("type","button");k.setAttribute("data-mark","md_dialog_button");if(m){k.innerHTML=j;f[j].elem=k;g.appendChild(k)}});g.parentNode.style.display=i.length?"":"none";return h},close:function(){var g=this,f=g.config.closeFn,e=g.DOM.wrap;if(g.closed){return g}if(typeof f==="function"&&f.call(g,d)===false){return g}g.closed=true;b.removeEvent(e,"click",g._wrapClick);b.removeEvent(e,"mousedown",g._wrapDown);g._elemBack&&g._elemBack();if(g.iframe){g.iframe.className="";g.iframe.src=null;g.iframe.parentNode.removeChild(g.iframe);g.iframe=null}e.parentNode.removeChild(e);a.defaults.zIndex-=1;if(g.mask){g.mask.parentNode.removeChild(g.mask);g.mask=null}a.list[g.config.id]=null;delete a.list[g.config.id]},lock:function(){var f=this,e=f.config,g=a.defaults.zIndex;f.mask=c.createElement("div");f.mask.style.cssText="position:fixed;_position:absolute;left:0;top:0;width:100%;height:100%;background:"+e.bg+"; opacity:"+e.opacity+";z-index:"+g+";";f.mask.style.filter="alpha(opacity:"+e.opacity*100+")";if(b.isIE6){f.mask.style.height=Math.max(c.documentElement.scrollHeight,c.documentElement.clientHeight)+"px";f.mask.innerHTML='<iframe src="about:blank" style="width:100%;height:100%;position:absolute;top:0;left:0;filter:alpha(opacity=0)"></iframe>'}c.body.appendChild(f.mask);return f},time:function(f){var e=this;e.timer&&clearTimeout(e.timer);if(f&&typeof f==="number"){e.timer=setTimeout(function(){e.close()},f*1000)}return e},ad:function(e){if(!e){this.DOM.advert.parentNode.style.display="none";return this}this.DOM.advert.innerHTML=e;return this},setLimit:function(){var e=this;e.limit=(function(){var g,f,i=e.DOM.wrap,l=i.style.position==="fixed",k=i.offsetWidth,p=i.offsetHeight,m=c.documentElement.clientWidth,h=c.documentElement.clientHeight,o=c.documentElement.scrollTop||c.body.scrollTop,q=c.documentElement.scrollLeft||c.body.scrollLeft,n=l?0:q,j=l?0:o;g=m-k+n;f=h-p+j;return{minX:n,minY:j,maxX:g,maxY:f}})();return e},_click:function(e){var g=this,f=g._listeners[e]&&g._listeners[e].callback;return typeof f!=="function"||f.call(g,d)!==false?g.close():g},_percenttoNumber:function(e,f){if(!e&&e!==0||typeof e==="number"){return e}if(e.indexOf("%")!==-1){e=parseInt(f*e.split("%")[0]/100)}return e},_setWrapSize:function(){var h=this,g=h.DOM,f=g.wrap,e=h.config;if(e.width==="auto"){f.style.width="auto";setTimeout(function(){f.style.width=f.offsetWidth+"px"},0)}if(e.height==="auto"){f.style.height="auto";setTimeout(function(){f.style.height=f.offsetHeight+"px"},0)}if(b.isIE6){setTimeout(function(){g.ie6fix.style.height=f.offsetHeight+"px";g.ie6fix.style.width=f.offsetWidth+"px"},0)}},_addEvent:function(){var i=this,h=i.DOM,g=h.wrap,f=g.style,e=i.config;i._wrapClick=function(l){var k=b.getEvent(l),j=b.getTarget(k);if(j===h.close_btn){i.close()}if(j.nodeName.toLowerCase()==="button"&&j.getAttribute("data-mark")==="md_dialog_button"){i._click(j.innerHTML)}i._setWrapSize()};i._wrapDown=function(r){var v=b.getEvent(r),y=b.getTarget(v),m=g.offsetLeft,k=g.offsetTop,n=v.clientX-m,w=v.clientY-k,x,o,u,s,j,q=function(A){var l=b.getEvent(A),C=l.clientX-n,B=l.clientY-w,z,t;if(o){if(C<o.minX+x){z=o.minX}else{if(C>o.maxX-x){z=o.maxX}else{z=C}}if(B<o.minY+x){t=o.minY}else{if(B>o.maxY-x){t=o.maxY}else{t=B}}}else{s=document.documentElement.scrollTop||document.body.scrollTop;u=g.style.position==="fixed"?0:s;j=B<=u?u:B;z=C;t=j}f.left=z+"px";f.top=t+"px";return false},p=function(){b.removeEvent(c,"mousemove",q);b.removeEvent(c,"mouseup",p);if(y.releaseCapture){y.releaseCapture()}};g.style.zIndex=a.defaults.zIndex+=1;if(y===h.title){if(!e.drag){return false}if(e.limit){i.setLimit();o=i.limit;x=e.magnetic&&typeof e.magnetic==="number"?e.magnetic:0}if(y.setCapture){y.setCapture()}if(v.preventDefault){v.preventDefault();v.stopPropagation()}if(b.isIE){v.returnValue=false;v.cancelBubble=true}b.clsSelect();b.addEvent(c,"mousemove",q);b.addEvent(c,"mouseup",p)}};b.addEvent(g,"click",i._wrapClick);b.addEvent(g,"mousedown",i._wrapDown)},_getDOM:function(){var l=c.createElement("div"),k="",e=c.body;l.style.cssText="position:absolute;left:0;top:0;";if(b.isIE6){k='<iframe class="md_dialog_ie6fix" src="about:blank" style="position:absolute;top:0;left:0;z-index:-1;filter:alpha(opacity=0);"></iframe>'}l.innerHTML=k+this.template;e.appendChild(l);var g,j=0,m={wrap:l},h=l.getElementsByTagName("*"),f=h.length;for(;j<f;j++){g=h[j].className.split("md_dialog_")[1];if(g){m[g]=h[j]}}return m},template:'<div class="md_dialog_layer"><table class="md_dialog_table"><tr class="md_dialog_head"><td><div class="md_dialog_bar"><div class="md_dialog_title"></div><a href="javascript:void(0)" class="md_dialog_close_btn">&times;</a></div></td></tr><tr><td class="md_dialog_body"><div class="md_dialog_content"><div class="md_dialog_icon"></div><div class="md_dialog_txt"></div></div> </td></tr><tr><td class="md_dialog_foot"></td></tr><tr><td class="md_dialog_advert"></td></tr></table></div>'};a.list={};a.defaults={width:"auto",height:"auto",title:"\u6807\u9898",content:'<div class="md_dialog_loading"></div>',left:"50%",top:"40%",zIndex:10000,drag:true,padding:"20px 25px",lock:true,fixed:false,icon:null,bg:"#000",opacity:0.3,closeFn:null,time:0,ad:null,button:null,style:null,limit:true,magnetic:null,init:null,autoMiddle:true};if(typeof define==="function"){define("webdialog",[],function(){return a})}else{d.webAlert=a}})();
